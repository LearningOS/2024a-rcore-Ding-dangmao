# 实现功能

​	获取一个任务的任务状态,系统调用次数,与损耗时间 。为任务上下文添加bool标记第一次开始时间点,并记录,将记录系统调用次数的数组一并存入,在进行系统调用时,根据全局变量TASK_MANAGER与系统调用id对数组进行操作并记录。

# 简答题

## 1.

U模式下运行的应用程序访问S模式特权级下才能访问的寄存器导致报错,访问特权级CSR,内核杀死了这个应用

## 2.

1. a0指向内核栈的栈指针.__restore用来①恢复任务切换上下文,还有②任务初始时执行的初始化操作 
2. t0 t1 t2是临时寄存器,由于无法从栈中直接恢复sstatus数据,需要先存储到寄存器中再恢复。 t0负责恢复sstatus,其存储,CPU特权级信息,t1恢复的epc则是记录了Trap发生之前执行的最后一条代码的下一条代码信息,t2恢复的sscratch则是恢复其指向的用户栈
3. x2在下边会有独特的保存形式,而x4则是用不到不必保存
4. sp重新指回用户栈,sscratch则是内核栈
5. 发生在最后一条sret, sret是高特权级S模式的特权指令,效果是从S模式返回U模式 
6. sp指向内核栈,sscratch指向用户栈
7. trap_handler

## 荣誉准则

1. 在完成本次实验的过程（含此前学习的过程）中，我曾分别与 **以下各位** 就（与本次实验相关的）以下方面做过交流，还在代码中对应的位置以注释形式记录了具体的交流对象及内容：

   > 无

2. 此外，我也参考了 **以下资料** ，还在代码中对应的位置以注释形式记录了具体的参考来源及内容：

   > [rCore-Camp-Guide-2024A 文档](https://learningos.cn/rCore-Camp-Guide-2024A/index.html)
   >
   > **rCore-Tutorial-Book**

3. 我独立完成了本次实验除以上方面之外的所有工作，包括代码与文档。 我清楚地知道，从以上方面获得的信息在一定程度上降低了实验难度，可能会影响起评分。

4. 我从未使用过他人的代码，不管是原封不动地复制，还是经过了某些等价转换。 我未曾也不会向他人（含此后各届同学）复制或公开我的实验代码，我有义务妥善保管好它们。 我提交至本实验的评测系统的代码，均无意于破坏或妨碍任何计算机系统的正常运转。 我清楚地知道，以上情况均为本课程纪律所禁止，若违反，对应的实验成绩将按“-100”分计。

## 建议

难度中,工作量小